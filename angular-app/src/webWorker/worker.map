{"version":3,"sources":["webpack:///webpack/bootstrap 5aada93b1cedd39d800a","webpack:///./src/webWorker/action.ts"],"names":[],"mappings":"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","file":"worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5aada93b1cedd39d800a","onmessage = (e: MessageEvent) => {\n    console.log(e.data);\n    initMap();\n    soldierList = initSoldierRand();\n    initSoldierNumDict();\n    initDistMatrix(soldierList);\n    gameRunning = true;\n\n    start();\n};\n\n// var UNIT_SIZE = 3; // px\n// var MAP_WIDTH_UNIT = 200;\n// var MAP_HEIGHT_UNIT = 200;\n// var SOLDIER_NUM_EACH = 1000;\n// var COLOR_NUM = 2;\n// var COLOR_LIST = [\"red\", \"blue\", \"green\", \"black\", \"purple\"];\n// var SIGHT_RANGE_UNIT = 500; // how far can a soldier can see in sight\n// var SHOOT_RANGE_UNIT = 50; // how far can a bullet can shoot\n// var GAME_TOTAL_TIME = 60; // in seconds\nvar param = null;\n\nvar gameRunning = true;\nvar distMatrix = null;\nvar map = null;\nvar dictSoldierNum = {};\nvar youWin = null;\nvar soldierList = null;\nvar nextSoldierId = 0;\n\nvar initMap = function() {\n    map = new Array(MAP_WIDTH_UNIT);\n    for (var i = 0; i < MAP_WIDTH_UNIT; i++) {\n        map[i] = new Array(MAP_HEIGHT_UNIT);\n    }\n    resetMap();\n    youWin = null;\n    return map;\n}\n\nvar resetMap = function() {\n    for (var i = 0; i < MAP_WIDTH_UNIT; i++) {\n        for (var j = 0; j < MAP_HEIGHT_UNIT; j++) {\n            map[i][j] = null;\n        }\n    }\n}\n\nvar initSoldierRand = function() {\n    var soldierList = new Array();\n    for (var i = 0; i < COLOR_NUM; i++) {\n        var color = COLOR_LIST[i];\n        for (var j = 0; j < SOLDIER_NUM_EACH; j++) {\n            var x = Math.floor(Math.random() * MAP_WIDTH_UNIT);\n            var y = Math.floor(Math.random() * MAP_HEIGHT_UNIT);\n            var position = new Position(x, y);\n            if (i == 0) {\n                // init players\n                var soldier = new Player(position, color);\n            } else {\n                // init robots\n                var soldier = new Robot(position, color);\n            }\n            soldierList.push(soldier);\n        }\n    }\n    return soldierList;\n}\n\nvar initSoldierNumDict = function() {\n    for (var i = 0; i < COLOR_NUM; i++) {\n        var color = COLOR_LIST[i];\n        dictSoldierNum[color] = SOLDIER_NUM_EACH;\n    }\n}\n\nvar initDistMatrix = function(soldierList) {\n    distMatrix = new Array(soldierList.length);\n    for (var i = 0; i < soldierList.length; i++) {\n        distMatrix[i] = new Array(soldierList.length);\n    }\n    return distMatrix;\n}\n\nvar updateDistMatrix = function(soldierList) {\n    for (var i = 0; i < soldierList.length; i++) {\n        var soldier1 = soldierList[i];\n        if (!soldier1.alive) {\n            continue;\n        }\n        map[soldier1.pos.x][soldier1.pos.y] = soldier1;\n        for (var j = i+1; j < soldierList.length; j++) {\n            var soldier2 = soldierList[j];\n            if (!soldier2.alive) {\n                continue;\n            }\n            var dist = soldier1.distWithSoldier(soldier2);\n            distMatrix[soldier1.id][soldier2.id] = dist;\n            distMatrix[soldier2.id][soldier1.id] = dist;\n        }\n    }\n}\n\nvar updateHealth = function(soldierList) {\n    var deadSet = new Set(); // Everybody only dies once\n    for (var i = 0; i < soldierList.length; i++) {\n        var soldier1 = soldierList[i];\n        if (!soldier1.alive || soldier1.bullet == null) {\n            continue;\n        }\n        var minDistFromVictimCandi = Number.MAX_SAFE_INTEGER;\n        var victimFinal = null;\n        for (var j = 0; j < soldierList.length; j++) {\n            if (j == i) {\n                continue; // skip self\n            }\n            var soldier2 = soldierList[j];\n            if (!soldier2.alive) {\n                continue;\n            }\n            var dist = distMatrix[soldier1.id][soldier2.id];\n            if (dist < minDistFromVictimCandi &&\n                dist <= SHOOT_RANGE_UNIT &&\n                soldier2.shootableBy(soldier1)) {\n                minDistFromVictimCandi = dist;\n                victimFinal = soldier2;\n            }\n        }\n        if (victimFinal != null) {\n            victimFinal.shotBy(soldier1, minDistFromVictimCandi);\n            if (!deadSet.has(victimFinal.id) && victimFinal.hp <= 0) {\n                deadSet.add(victimFinal.id);\n                dictSoldierNum[victimFinal.color]--;\n            }\n        }\n    }\n}\n\nvar checkWinner = function() {\n    var end = false;\n    for (var color in dictSoldierNum) {\n        if (dictSoldierNum[color] <= 0) {\n            end = true;\n        }\n    }\n    if (end) {\n        youWin = dictSoldierNum[COLOR_LIST[0]]>dictSoldierNum[COLOR_LIST[1]];\n        postMessage(youWin? \"You win\" : \"You lose\");\n        gameRunning = false;\n    }\n}\n\nvar run = function() {\n    if (gameRunning) {\n        checkWinner();\n        resetMap();\n        updateDistMatrix(soldierList);\n        updateHealth(soldierList);\n\n        for (var i in soldierList) {\n            soldier = soldierList[i];\n            soldier.refresh();\n            if (soldier.alive) {\n                try {\n                    soldier.nextAction();\n                } catch(e) {\n                    console.log(\"Error: \" + e);\n                    gameRunning = false;\n                    return;\n                }\n            }\n        }\n        postMessage(soldierList);\n        setTimeout(run, 10);\n    }\n}\n\nvar start = function() {\n    run();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/webWorker/action.ts"],"sourceRoot":""}